<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SHEIN Instant Watcher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; padding: 15px; background:#f5f5f5 }
    h2 { text-align:center }
    button {
      width:100%; padding:14px; margin:8px 0;
      font-size:16px; background:#000; color:#fff; border:none;
    }
    .box {
      background:#fff; padding:10px; margin-top:10px; border-radius:6px;
    }
  </style>
</head>

<body>

<h2>SHEIN Instant Watcher</h2>

<p>1️⃣ Open a SHEIN category page in this tab<br>
2️⃣ Click "Scan Page"<br>
3️⃣ Open in SHEIN app</p>

<button onclick="scan()">SCAN PAGE</button>

<div id="result"></div>

<script>
const allowedSizes = ["XL","L","28","30","32"];

function scan() {
  let products = document.querySelectorAll("a");
  let matches = [];

  products.forEach(a => {
    let text = a.innerText.toUpperCase();
    if (text.includes("MEN")) {
      for (let s of allowedSizes) {
        if (text.includes(s)) {
          matches.push(a.href);
          break;
        }
      }
    }
  });

  showResults(matches.slice(0,10));
}

function showResults(list) {
  let html = "";
  if (list.length === 0) {
    html = "<div class='box'>❌ No matching products found</div>";
  } else {
    html = "<div class='box'><b>Matches found:</b><br>";
    list.forEach(l => {
      let id = l.match(/\d+/);
      if (id) {
        html += `<button onclick="openShein('${id[0]}')">
          Open Product ${id[0]}
        </button>`;
      }
    });
    html += "</div>";
  }
  document.getElementById("result").innerHTML = html;
}

function openShein(id) {
  window.location.href = "shein://product/" + id;
}
</script>

</body>
</html>
